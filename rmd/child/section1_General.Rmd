---
title: "section1_General"
author: 'NYSDEC SMAS : Keleigh Reynolds'
date: "4/14/2020"
output: 
word_document: default
---

```{r include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r include=FALSE,message=FALSE,warning=FALSE}

file.path.s=file.path(here::here(),
          "data",
          "sites_wallkill.csv")

sites<-read.csv(file.path.s,stringsAsFactors = FALSE)

```


```{r include=FALSE,message=FALSE,warning=FALSE}
#Table 1
#renames column in the sites table to match
library(dplyr)

table1<-sites %>% 
select(SH_SITE_ID,group,SH_RIVMILE,SH_PWL_ID,SH_WQ_STANDARD,SH_DESC,SH_LATITUDE,SH_LONGITUDE,order) %>% 
  distinct() %>% 
  arrange(order)

table1<-table1 %>% rename("Location ID"=SH_SITE_ID,
                          "Group"=group,
                  "Rivermile"=SH_RIVMILE,
                  "WI/PWL"=SH_PWL_ID,
                  "Waterbody Classification"=SH_WQ_STANDARD,
                  "Description"=SH_DESC,
                  "Latitude"=SH_LATITUDE,
                  "Longitude"=SH_LONGITUDE)

table1$Description<-toupper(table1$Description)

#remove order column for table disply
table1$order<-NULL

table1<-table1 %>% 
  rename("Waterbody \n Classification"=`Waterbody Classification`)


```

```{r tab.id="sites-table",  echo=FALSE, message=FALSE, warning=FALSE, tab.cap="Wallkill River (WALK) sampling locations. Locations are ordered from upstream to downstream according to river mile and mainstem confluence"}
library(flextable)
tl<-flextable(table1) %>% font(i = NULL, j = NULL, fontname="Arial", part = "all") %>% theme_zebra() %>% autofit()
tl<-align(tl, i = NULL, j =(2:5) , align = "center", part = "all")%>%
  fontsize(size=8, part = "all")%>%
  fontsize(j=6, size=7)%>%
  width(j=c(1), width=1)%>%
  width(j=c(5), width=0.8)%>%
  width(j=c(4,7,8), width=0.6)%>%
  width(j=c(2), width=0.7)%>%
  width(j=c(3), width=0.5)%>%
  width(j=6, width=2.5)
tl
```


```{r site-map, fig.cap="Map of Wallkill River (WALK) sampling locations. Site names reference the Location ID and River Mile presented in \\@ref(tab:sites-table)", echo=FALSE, message=FALSE, warning=FALSE}
#library(leaflet)
#map function
  #bounding box
library(ggmap)
nybox<-make_bbox(sites,lon=SH_LONGITUDE,lat=SH_LATITUDE)
 
ny.map<-qmap(nybox, source = "osm")+geom_point(data=sites,aes(x=SH_LONGITUDE,y=SH_LATITUDE,label=SH_SITE_ID,color=group),size=4)+ geom_label_repel(data=sites,
    label= sites$SH_SITE_ID, 
    aes(x=SH_LONGITUDE,
    y=SH_LATITUDE),box.padding   = 0.35, point.padding = 0.5,
                  segment.color = 'grey50',size=1.5)


ny.map

  
```







